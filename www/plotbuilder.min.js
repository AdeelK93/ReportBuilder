function radioSet(d,c){$('input[name="'+d+'"][value="'+c+'"]').prop("checked",!0)}function modalBar(){updateEditor(modalQuery().concat("geom_bar(stat='summary',fun.data=mean_se) +\n geom_errorbar(stat='summary',fun.data=mean_se,size=.8,width=.2,color='black') +\n theme(legend.position='none')"));$("#shiny-modal").modal("hide")}function modalBox(){updateEditor(modalQuery().concat("geom_boxplot(color='black') +\n theme(legend.position='none')"));$("#shiny-modal").modal("hide")}function modalLine(){updateEditor(modalQuery().concat("geom_line(aes(group=Battery.ID))"));$("#shiny-modal").modal("hide")}function modalLine2(){updateEditor(modalQuery().concat("geom_line(stat='summary',fun.data=mean_se) +\n geom_ribbon(stat='summary',fun.data=mean_se,alpha=.3,color=NA,show.legend=F)"));$("#shiny-modal").modal("hide")}function modalQuery(){var f="";switch($("ul li.active").index()){case 0:var c=modalID.replace("e","t");if(!document.getElementById(c).value.length){var e=$('input[name="modalq"]:checked').val();document.getElementById(c).value=e;Shiny.onInputChange(c,e)}switch($('input[name="modalq"]:checked').val()){case"Discharge Capacity":f="summarize(DisCap=-min(Amp.Hours)) %>%\n ggplot(aes(Type,DisCap,color=Type,fill=Type)) + ylab('Discharge Capacity (Ah)')";break;case"Reserve Capacity":f="filter(Amp.Hours==min(Amp.Hours)) %>%\n ggplot(aes(Type,Step.time/60,color=Type,fill=Type)) + ylab('Reserve Capacity (min)')";break;case"Ah In During Charge":f="summarize(AhIn=max(Amp.Hours)) %>%\n ggplot(aes(Type,AhIn,color=Type,fill=Type)) + ylab('Ah In During Charge')";break;case"%Ah In During Charge":f="mutate(RF=-Amp.Hours/min(Amp.Hours)) %>% summarize(RFmax=max(RF)) %>%\n ggplot(aes(Type,RFmax*100,color=Type,fill=Type)) + ylab('% Ah In During Charge')";break;case"Time to 100% Recharge Factor":f="mutate(RF=-Amp.Hours/min(Amp.Hours)) %>% summarize(TimeTo100=Step.time[which.min(abs(RF-1))]) %>%\n ggplot(aes(Type,TimeTo100/3600,color=Type,fill=Type)) + ylab('Time to 100% Ah In During Charge (hr)')";break;case"CCA Duration":f="filter(Current<0) %>% summarize(Duration=max(Step.time)) %>%\n ggplot(aes(Type,Duration,color=Type,fill=Type)) + ylab('CCA Duration (s)')";break;case"Voltage After 30s":f="filter(Current<0) %>% summarize(V30s=Voltage[which.min(abs(Step.time-30))]) %>%\n ggplot(aes(Type,V30s,color=Type,fill=Type)) + ylab('Voltage After 30s of Discharge')";break;case"Time to 6V":f="filter(Current<0) %>% summarize(TimeTo6V=Step.time[which.min(abs(Voltage-6))]) %>%\n ggplot(aes(Type,TimeTo6V,color=Type,fill=Type)) + ylab('Discharge Time to 6V (s)')";break;case"Current at 10m":f="filter(Current>0) %>% summarize(Cur10m=Current[which.min(abs((Step.time/60)-10))]) %>%\n ggplot(aes(Type,Cur10m,color=Type,fill=Type)) + ylab('Current at 10m')";break;case"Ah In at 10m":f="filter(Current>0) %>% summarize(Ah10m=Amp.Hours[which.min(abs((Step.time/60)-10))]) %>%\n ggplot(aes(Type,Ah10m,color=Type,fill=Type)) + ylab('Ah In at 10m')";break;case"Minimum Discharge Voltage":f="summarize(MinVolt=min(Voltage)) %>%\n ggplot(aes(Cycle,MinVolt,color=Type,fill=Type)) + ylab('Minimum Discharge Voltage')";break;case"BOC Voltage":f="filter(Step.time==min(Step.time)) %>%\n ggplot(aes(Cycle,Voltage,color=Type,fill=Type)) + ylab('Beginning of Charge Voltage')";break;case"EOC Voltage":f="filter(Step.time==max(Step.time)) %>%\n ggplot(aes(Cycle,Voltage,color=Type,fill=Type)) + ylab('End of Charge Voltage')";break;case"BOC Current":f="filter(Step.time==min(Step.time)) %>%\n ggplot(aes(Cycle,Current,color=Type,fill=Type)) + ylab('Beginning of Charge Current')";break;case"EOC Current":f="filter(Step.time==min(Step.time)) %>%\n ggplot(aes(Cycle,Current,color=Type,fill=Type)) + ylab('End of Charge Current')";break;default:console.error("Could not find query selector")}break;case 1:f="ggplot(aes(".concat(document.getElementById("modalcx").value,",",document.getElementById("modalcy").value,",color=Type,fill=Type))");break;case 2:var b=document.getElementById("modaldx").value;var d=document.getElementById("modaldv").value;var a=document.getElementById("modaldy").value;if(!isNaN(parseInt(d))){f="summarize(Variable=".concat(a,"[which.min(abs(",b,"-",d,"))]) %>%\n ggplot(aes(Type,Variable,color=Type,fill=Type))")}else{if(b==a){f="summarize(Variable=".concat(d,"(",b,")) %>%\n ggplot(aes(Type,Variable,color=Type,fill=Type))")}else{f="filter(".concat(b,"==",d,"(",b,")) %>%\n ggplot(aes(Type,",a,",color=Type,fill=Type))")}}break;default:console.error("Could not find tab index")}return"x %>% group_by(Battery.ID,Type,Cycle) %>%\n ".concat(modalFilter(),f," +\n ")}function modalFilter(){var g=$('input[id="filter.voltage"]')[0].value.split(";");var c=$('input[id="filter.voltage"]')[0].dataset;var d=$('input[id="filter.current"]')[0].value.split(";");var a=$('input[id="filter.current"]')[0].dataset;var k=$('input[id="filter.amphours"]')[0].value.split(";");var i=$('input[id="filter.amphours"]')[0].dataset;var l=$('input[id="filter.totaltime"]')[0].value.split(";");var j=$('input[id="filter.totaltime"]')[0].dataset;var e=$('input[id="filter.steptime"]')[0].value.split(";");var b=$('input[id="filter.steptime"]')[0].dataset;var m=$('input[id="filter.step"]')[0].value;var h="";if(g[0]!=c.min){h=h.concat("Voltage>=",g[0],",")}if(g[1]!=c.max){h=h.concat("Voltage<=",g[1],",")}if(d[0]!=a.min){h=h.concat("Current>=",d[0],",")}if(d[1]!=a.max){h=h.concat("Current<=",d[1],",")}if(k[0]!=i.min){h=h.concat("Amp.Hours>=",k[0],",")}if(k[1]!=i.max){h=h.concat("Amp.Hours<=",k[1],",")}if(l[0]!=j.min){h=h.concat("Total.Time>=",l[0],",")}if(l[1]!=j.max){h=h.concat("Total.Time<=",l[1],",")}if(e[0]!=b.min){h=h.concat("Step.time>=",e[0],",")}if(e[1]!=b.max){h=h.concat("Step.time<=",e[1],",")}if(m!=0){h=h.concat("Step==",m,",")}if(h.length){h=h.substring(0,h.length-1);h="filter(".concat(h,") %>%\n ")}return h};